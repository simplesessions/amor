var Amortizer;Amortizer=function(){function t(t,a,n,e){this.years=t,this.loanAmount=a,this.interest=n,this.startDate=e,this.extraPrincipalPayments=[],this.update(this.years,this.loanAmount,this.interest,this.startDate)}return t.prototype.update=function(t,a,n,e){return this.years=t,this.loanAmount=a,this.interest=n,this.startDate=e,this.stateDate=moment(this.stateDate),this.numPayments=12*this.years,this.monthlyPayment=this.calculateMonthlyPayment(),this.totalPayment=this.monthlyPayment*this.numPayments,this.totalInterest=this.totalPayment-this.loanAmount},t.prototype.payExtra=function(t,a){var n;return t=moment(t).format("YYYY MM"),n=parseFloat(a),t in this.extraPrincipalPayments?this.extraPrincipalPayments[t].push(n):this.extraPrincipalPayments[t]=[n]},t.prototype.calculateMonthlyPayment=function(){var t;return t=this.interest/12,this.loanAmount*t*Math.pow(1+t,this.numPayments)/(Math.pow(1+t,this.numPayments)-1)},t.prototype.paymentForBalance=function(t){var a,n,e;return n=this.interest/12*t,e=this.monthlyPayment-n,e>=t?(e=t,a=0):a=t-(this.monthlyPayment-this.interest/12*t),{interestPmt:n,principalPmt:e,balance:a}},t.$=function(t){return accounting.formatMoney(Math.round(100*t)/100)},t.emptyRow=function(){return{year:"undefined",interestPmt:0,principalPmt:0,balance:0}},t.prototype.buildTable=function(){var a,n,e,r,i,s,m,o,h,y,l,p;for(r="",e=this.startDate,i=12*this.years,n=this.loanAmount,o=t.emptyRow(),o.year=this.startDate.format("YYYY"),s=h=0;i>=0?i>h:h>i;s=i>=0?++h:--h){if(m=this.paymentForBalance(n),n=m.balance,r+="<tr>",r+="<td>"+e.format("MMM YYYY")+"</td>",r+="<td>"+t.$(m.interestPmt)+"</td>",r+="<td>"+t.$(m.principalPmt)+"</td>",r+="<td>"+t.$(n)+"</td>",r+="</tr>",e.format("YYYY MM")in this.extraPrincipalPayments)for(p=this.extraPrincipalPayments[e.format("YYYY MM")],y=0,l=p.length;l>y;y++)a=p[y],n-=a,r+='<tr class="extra">',r+="<td>"+e.format("MMM YYYY")+" +</td>",r+="<td>&ndash;</td>",r+="<td>(+) "+t.$(a)+"</td>",r+="<td>"+t.$(n)+"</td>",r+="</tr>";if(o.interestPmt+=m.interestPmt,o.principalPmt+=m.principalPmt,o.balance+=n,e=e.add(1,"months"),e.format("YYYY")!==o.year&&(r+='<tr class="year-summary">',r+="<th>"+o.year+"</th>",r+="<th>"+t.$(o.interestPmt)+"</th>",r+="<th>"+t.$(o.principalPmt)+"</th>",r+="<th>"+t.$(n)+"</th>",r+="</tr>",o=t.emptyRow(),o.year=e.format("YYYY")),0===n)break}return r},t}();
//# sourceMappingURL=./amortizer.js.map